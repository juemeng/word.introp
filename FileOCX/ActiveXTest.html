<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" > 

<html>
  <head>
    <title>WebForm1</title>
    <meta name="GENERATOR" Content="Microsoft Visual Studio .NET 7.1">
    <meta name="CODE_LANGUAGE" Content="C#">
    <meta name=vs_defaultClientScript content="JavaScript">
    <meta name=vs_targetSchema content="http://schemas.microsoft.com/intellisense/ie5">
  </head>
  <body onload="OpenActiveX()">

  <!-- Our activeX object -->
  <OBJECT id="OurActiveX" name=OurActiveX" classid="clsid:EFA92E6A-1DFB-4F6C-A51E-5E094213510A" VIEWASTEXT codebase="OurActiveX.cab"></OBJECT>	


<script language="javascript">
	//Passing parameters to ActiveX object and starting application
        function OpenActiveX()
        {
	        try {
	            document.OurActiveX.Directory = "e:\\1"; //Passing parameter to the ActiveX
	            var arr = document.OurActiveX.GetFiles();
	            //Running method from activeX
	            alert(arr);
//	            for (var i = 0; i < arr.length; i++) {
//	                alert(arr[i]);
//	            }
	        }
	        catch(Err)
	        {
		        alert(Err.description);
	        }
        }	
</script>

  </body>
</html>
