<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" > 

<html>
  <head>
    <title>WebForm1</title>
    <meta name="GENERATOR" Content="Microsoft Visual Studio .NET 7.1">
    <meta name="CODE_LANGUAGE" Content="C#">
    <meta name=vs_defaultClientScript content="JavaScript">
    <meta name=vs_targetSchema content="http://schemas.microsoft.com/intellisense/ie5">
  </head>
  <body onload="OpenActiveX()">

  <!-- Our activeX object -->
  <OBJECT id="OurActiveX" name=OurActiveX" classid="clsid:EFA92E6A-1DFB-4F6C-A51E-5E094213510A" VIEWASTEXT codebase="OurActiveX.cab"></OBJECT>	
  <img id="myImg" src=""/>
  <img id="myImg1" src="" />
      <img id="myImg2" src="" />
      <img id="myImg3" src="" />

<script language="javascript">
	//Passing parameters to ActiveX object and starting application
        function OpenActiveX()
        {
	        try {
	            document.OurActiveX.Directory = "C:\\test"; //Passing parameter to the ActiveX

	            var files = document.OurActiveX.GetFiles(4);
	            

	            var image = document.OurActiveX.GetImage(files[0]);
	            var image1 = document.OurActiveX.GetImage("C:\\test\\2.jpg");
	            var image2 = document.OurActiveX.GetImage("C:\\test\\3.gif");
	            var image3 = document.OurActiveX.GetImage("C:\\test\\4.png");

	            document.getElementById("myImg").setAttribute('src',image);
	            document.getElementById("myImg1").setAttribute('src', image1);
	            document.getElementById("myImg2").setAttribute('src', image2);
	            document.getElementById("myImg3").setAttribute('src', image3);
	            //alert(arr);
	            //for (var i = 0; i < arr.length; i++) {
	            //    alert(arr[i]);
	            //}
	        }
	        catch(Err)
	        {
		        alert(Err.description);
	        }
        }	
</script>

  </body>
</html>
